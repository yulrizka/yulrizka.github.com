<!DOCTYPE html>
<html lang="en">
<head>
<title>labs.yulrizka.com - Safely sharing credentials with PGP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Safe way to send message or share credentials with teams">
<meta name="author" content="Ahmy Yulrizka">
<meta http-equiv="Content-Language" Content="en">
<meta name="keywords" content="linux, GPG, PGP, authentication share, share password" />
<meta http-equiv="date" content="2013-07-08T16:24:00+02:00" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="canonical" href="http://ahmy.yulrizka.com/">
<!-- Framework CSS -->
<link href="/stylesheets/application.css" media="screen, projection" rel="stylesheet" type="text/css" />

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
</head>
<body>
<div id="container" class="sidebar-right">
  <div class="container-fluid" id="main">
    <div class="row-fluid">
      <div id="content-wrapper" class="span9 ">
        <div class="content">
          <article>
            <h1>Safely sharing credentials with PGP</h1>
            <div class="posted_at">08 Jul 2013</div>
            
            <p>When working in teams, we are sometimes required to share some password / keys with our team.
The most common way for me is probably through email or some chat client. But even though its convenience it's not
actually a secure and a good practice. Especially if you are providing a service that deal with sensitive information.</p>

<p>Some simple approach would we communicating the password directly with a person through secure medium.
One way to do it is both party ssh through a server and use talk client like <a href="http://linux.die.net/man/1/write">write</a>.
But for some cases it's quite impractical.</p>

<h2>PGP</h2>

<p>Enter <a href="http://en.wikipedia.org/wiki/Pretty_Good_Privacy">PGP</a>. It's basically a software that do a Public-key cryptography.
Public-key cryptography is basically encryption process which require 2 keys, one for encrypting and the other one
for decrypting. Usually the <strong>public key</strong> is used for encrypting and <strong>private key</strong> is use for decrypting.
I would not dive into the details about it since I've only have basic understanding about it.
But for those people that is interested, you would read the nice article on <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">wikipedia</a></p>

<p>There is a open source project called GPG (GNU Privacy Guard) and in this article I would like to show you how we could
share some password / key file with it.</p>

<h3>Instalation</h3>

<p>If you don't already have it on your system, you could installed it with:</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>  <span class="nv">$ </span>sudo apt-get install gpg
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>After installing we would start by creating a pair of keys</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>  <span class="nv">$ </span>gpg --gen-key
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>You will be asked with bunch of questions. Most of the answer you could leave it as a default but most important is fill in your <strong>email</strong>
address and also provide a <strong>Passphrase</strong> to protect your key with password. When it finish gathering information, it will start
creating a key pair by using system entropy. You can help the system to generate the entropy by clicking or moving your mouse randomly
or doing some random IO disk by triggering for example <code>find /</code></p>

<h3>Listing keys</h3>

<p>After installing, you can see list of keys by using this command</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span> gpg --list-keys
</span><span class='line'>/home/user/.gnupg/pubring.gpg
</span><span class='line'>--------------------------------
</span><span class='line'>pub   2048R/70280895 2013-07-09
</span><span class='line'>uid                  Ahmy Yulrizka <span class="o">(</span>ahmy135@mail.com<span class="o">)</span> &lt;ahmy135@mail.com&gt;
</span><span class='line'>sub   2048R/F7B2D44C 2013-07-09
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>In above output you could see that we have created public key with id of <code>70280895</code>. Note this one because we are going to use it later
when submitting the key to a key server</p>

<h3>Exporting keys</h3>

<p>To share your public key, so other people could send you encrypted message.</p>

<p><strong>Note</strong> that further in this article I will discus ways to easily distribute your public key.</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gpg --armor --export <span class="s1">&#39;ahmy135@mail.com&#39;</span>
</span><span class='line'>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span><span class='line'>Version: GnuPG v1.4.11 <span class="o">(</span>GNU/Linux<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>mQENBFHcRTEBCAC056qG97iJAtb604x5Hr+3lIi3UXVOnGauoHSo5S8S3bSCD0Ib
</span><span class='line'>DzgSjWj8a6Xd1BY+5+HV0amp+i1sTknnd/C2WR7O1h9DIasPlWktPr2T+j4IGnYF
</span><span class='line'>...
</span><span class='line'>-----END PGP PUBLIC KEY BLOCK-----
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>gpg --armor --export <span class="s1">&#39;ahmy135@mail.com&#39;</span> --output pubkey.txt <span class="c"># to output it to a file</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<h3>Encrypting and decrypting</h3>

<p>With those generated keys, we could now do a personal encryption. That is if you want to encrypt a file and you are the only one
who are able to decrypt it.</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>  <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;this message is secret&quot;</span> &gt; message.txt
</span><span class='line'>  <span class="nv">$ </span>gpg --encrypt --recipient <span class="s1">&#39;ahmy135@gmail.com&#39;</span> message.txt
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Those code will create a file name <code>message.txt.gpg</code> which is encrypted message of <code>message.txt</code></p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gpg --decrypt message.txt.gpg
</span><span class='line'>
</span><span class='line'>You need a passphrase to unlock the secret key <span class="k">for</span>
</span><span class='line'>user: <span class="s2">&quot;Ahmy Yulrizka (ahmy135@mail.com) &lt;ahmy135@mail.com&gt;&quot;</span>
</span><span class='line'>2048-bit RSA key, ID F7B2D44C, created 2013-07-09 <span class="o">(</span>main key ID 70280895<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>gpg: gpg-agent is not available in this session
</span><span class='line'>gpg: encrypted with 2048-bit RSA key, ID F7B2D44C, created 2013-07-09
</span><span class='line'>      <span class="s2">&quot;Ahmy Yulrizka (ahmy135@mail.com) &lt;ahmy135@mail.com&gt;&quot;</span>
</span><span class='line'>this message is secret
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>As you can see that we are successfully decrypted the message. This example you encrypt the message
using your own public key. So this method only work if you want to archive or backup the file securely.
In order to send someone else an encrypted message, you need to encrypt the message using the other
person <strong>public key</strong></p>

<h3>Distributing the key</h3>

<p>In order for any body to send you a encrypted message, you need to give your <strong>public key</strong>.
Since <strong>public key</strong> only used for encryption, It's OK to publicly share your <strong>public key</strong>.
But never share your <strong>private key</strong>. Once the other party have your <strong>public key</strong> they could
start send you an encrypted message using the command above.</p>

<p>You could share your public key manually to some one (through usb / email etc) by exporting it first just like I mention before.
But there are an easy way to distribute the key. There are some public GPG server that store your public key so that
other people could easily find it and import it into their local machine. There are <a href="http://pgp.mit.edu">http://pgp.mit.edu</a>
and also ubuntu key server <a href="http://keyserver.ubuntu.com">http://keyserver.ubuntu.com</a> that we can use.</p>

<p>To send our key to MIT server we could do</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gpg --send-key --keyserver pgp.mit.edu 70280895
</span><span class='line'>gpg: sending key 70280895 to hkp server pgp.mit.edu
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>the last number <code>70280895</code> was the key id of the public file. You could find it with the output of <code>gpg --list-keys</code> command.
Now we have successfully send our public key any body could get your public key through that keyserver. You could test this
by searching a name or email or a person in the key server web interface. for example try searching my name on <a href="http://pgp.mit.edu/">http://pgp.mit.edu/</a></p>

<h3>Importing Keys</h3>

<p>Now to import other people public key, we could also do that in two way.</p>

<p>if the person give you a file which contain their public key (say <code>ahmy-pub.key</code>). you could import it with</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gpg --import ahmy-pub.key
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Or if the person already publish his public key to a keyserver, we can search it with</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gpg --search-keys <span class="s1">&#39;Ahmy Yulrizka&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># or</span>
</span><span class='line'><span class="nv">$ </span>gpg --search-keys <span class="s1">&#39;ahmy135@mail.com&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>It will generate a list of keys that found on the keyserver. Enter the number of the keys and it will be imported to your local machine.</p>

<p>after importing you can send an encrypted message to the person for example</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight bash'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;This is also a secret&quot;</span> | gpg --encrypt --armor --recipient <span class="s1">&#39;Ahmy Yulrizka&#39;</span> &gt; output.txt.gpg
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>You could provide a name or an email address as a recipient.
THis command will encrypt the message using public key of a person name <code>Ahmy Yulrizka</code></p>

<h2>Conclusion</h2>

<p>At this point you are able to generate, export, distribute and import keys. More over you can already encrypt
and decrypt file / message to a designated recipient. The the part two of this article I will share some idea
how we could share some password / password key to other member of the team.</p>

          </article>
          
          
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              //var disqus_developer = 1;
              var disqus_shortname = 'labs-yulrizka'; 
              var disqus_identifier = '/en/2013/07/safely-sharing-credentials-with-pgp.html';

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          
        </div>        
      </div>
      <div id="sidebar-wrapper" class="span3">
        <div class="sidebar">
          <aside>
          <h2>Archives</h2>
          <ul>
            

              
                <h3>2013</h3>
              

              <li>Jul <a href="/en/2013/07/berks-upload-ruby-core-dump.html">berks upload core dump</a></li>
            

              
                
                
                
              

              <li>Jul <a href="/en/2013/07/safely-sharing-credentials-with-pgp.html">Safely sharing credentials with PGP</a></li>
            

              
                
                
                
              

              <li>Feb <a href="/en/2013/02/homeward-light-indicator-with-raspberrypi-and-commonsense.html">Homeward light indicator with RaspberryPi and CommonSense</a></li>
            

              
                
                
                
                  <h3>2012</h3>
                
              

              <li>Mar <a href="/id/2012/03/scale-mongodb-dengan-sharding.html">Scale MongoDB dengan Sharding</a></li>
            

              
                
                
                
              

              <li>Feb <a href="/id/2012/02/ruby-fiber-apaan-sih.html">Ruby Fiber apaan sih ?</a></li>
            

              
                
                
                
              

              <li>Feb <a href="/en/2012/02/responsive-design.html">Responsive Design</a></li>
            

              
                
                
                
              

              <li>Jan <a href="/en/2012/01/jekyll-error-utf-8-caracter.html">Jekyll error utf-8 caracter</a></li>
            

              
                
                
                
              

              <li>Jan <a href="/en/2012/01/testing-ruby-code-with-benchmark-suite.html">Testing ruby code with benchmark_suite</a></li>
            
          </ul>
          </aside>
        </div>
      </div>
    </div>
  </div>

  <header>
  <div id="banner">
    <div id="carousel-banner" class="wrapper carousel">
      <div class="carousel-inner excerpt">
        <div class="item active">
          <div class="image labs"></div>
          <div class="text">
            <p class="title">Let each man exercise the art he knows</p>
            <p>Welcome to my canvas. A place for me to explore and experiment on some stuff that I found interesting.</p>
          </div>
        </div>
        <div class="item">
          <div class="image ruby"></div>
          <div class="text">
            <p class="title">Ruby (and Rails) </p>
            <p>Ruby is a neat language. People create clean, elegant and smart app with it. Rails is web framework built on top of ruby. In this category I will explore stuff related to ruby and also rails</p>
          </div>
        </div>
        <div class="item">
          <div class="image android"></div>
          <div class="text">
            <p class="title">Android</p>
            <p>Android are amazing mobile platform, it's open source and you can easily implement your idea of mobile application including tab with this platform. And this is my place to explore it</p>
          </div>
        </div>
        <div class="item">
          <div class="image web"></div>
          <div class="text">
            <p class="title">Web</p>
            <p>This is general category involving various aspect of web technology. I like to explore not only the programming and technology aspect of the web, but also the design </p>
          </div>
        </div>
        
      </div>
    </div> 
  </div>
  <div class="navbar navbar-fixed-top relative">  
    <div class="navbar-inner">    
      <div class="fill">
        <div class="container">
          <span class="brand" href="#">Labs.Yulrizka.com</span>
          <a class="btn btn-navbar" href="#" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <div id="page-view">
            <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" rel="popover" data-content="Arrange the sidebar position Left / Right / None" 
                data-original-title="Sidebar position" data-placement="left">
                  <i id="icon-panel" class="icon-right-panel icon-white"></i><b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a href="#" id="sidebar-left-link"><i class="icon-left-panel"></i> Left Panel</a></li>
                  <li><a href="#" id="sidebar-none-link"><i class="icon-no-panel"></i> No Panel</a></li>
                  <li><a href="#" id="sidebar-right-link"><i class="icon-right-panel"></i> Right Panel</a></li>
                </ul>
              </li>
            </ul>
          </div>            
          <div id="social-icon" class="pull-right">
            <a href="https://twitter.com/#!/yulrizka" target="twitter" rel="popover" data-content="Follow me on twitter" data-original-title="@yulrizka" data-placement="left"><img src="/images/icon/twitter.png" alt="twitter"></a>  
            <a href="https://github.com/yulrizka" target="github" rel="popover" data-content="Github is source code repository that encourage social coding. Fork my projects from github." data-original-title="Fork me on Github" data-placement="left"><img src="/images/icon/github.png" alt="github"></a>  
            <a href="http://feeds.feedburner.com/yulrizka/labs" target="feed" rel="popover" data-content="Suscribe this blog feed on feed burner" data-original-title="RSS feed" data-placement="left"><img src="/images/icon/feed.png" alt="feed"></a>  
          </div>
          <div class="nav-link nav-collapse">
            <ul class="nav">
              <li class="active banner"><a href="/">Home</a></li>
              <li class=""><a href="/ruby/">Ruby (and Rails)</a></li>
              <li class=""><a href="/android/">Android</a></li>
              <li class=""><a href="/web/">Web</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

      
  <footer>
  <div class="container-fluid">
    <div class="row-fluid">
      <div id="footer-wrapper" class="span9 <!-- sidebar-right -->">
        <div class="footer">
          <p>
            &copy; Ahmy Yulrizka 2012. This site is made with <a href="http://jekyllrb.com/">Jekyll</a> 
            using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a> 
            and hosted on <a href="http://pages.github.com/">Github pages</a>.
            All of the content is open and the source can be accessed
            <a href="https://github.com/yulrizka/yulrizka.github.com/tree/source">here</a>
          </p>
        </div>
      </div>
    </div>
 </div>
</footer>
</div> <!-- end of #container-->

<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/jquery-1.7.1.min.js"><\/script>')</script>
<script src="/javascripts/application.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22308054-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>