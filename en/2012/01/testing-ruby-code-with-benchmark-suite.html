<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>labs.yulrizka.com - Testing ruby code with benchmark_suite</title>
<meta name="description" content="Technical blog of Ahmy Yulrizka">
<meta name="author" content="Ahmy Yulrizka">

<!-- Framework CSS -->
<link href="/stylesheets/application.css" media="screen, projection" rel="stylesheet" type="text/css" />

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>


</head>
<body>
<div id="container" class="">
  <header>
    <div id="banner">
      <div class="wrapper">
        <ul class="excerpt">
          <li class="active">
            <div class="row">
              <div class="image span2"><img src="/images/icon/labs.png" alt=""/></div>
              <div class="text span14">
                <p class="title span">Let each man exercise the art he knows</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore e Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut </p>
              </div>
            </div>
          </li>
          <li>
            <div class="row">
              <div class="image span2"><img src="/images/icon/labs.png" alt=""/></div>
              <div class="text span14">
                <p class="title span">Ruby (and Rails) </p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore e Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut </p>
              </div>
            </div>
          </li>
          <li>
            <div class="row">
              <div class="image span2"><img src="/images/icon/labs.png" alt=""/></div>
              <div class="text span14">
                <p class="title span">Android</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore e Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut </p>
              </div>
            </div>
          </li>
        </ul>
      </div> 
    </div>
    <div class="topbar relative">      
      <div class="fill">
        <div class="container">
          <a class="brand" href="#">Labs.Yulrizka.com</a>
          <div id="drop-pane">
            <div class="wrapper">
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </div>
          </div>
          <ul class="nav">
            <li class="active banner"><a href="/">Home</a></li>
            <li class=""><a href="/">Ruby (and Rails)</a></li>
            <li class=""><a href="/">Android</a></li>
            </ul>
        </div>
      </div>
    </div>
  </header>


  <div class="container">
    <div class="row">
      <div class="sidebar span5">&nbsp;</div>
      <div class="content">
        <p>Just a couple days ago I found out <a href="http://www.therubygame.com" title="The Ruby Game">therubygame.com</a> which challenge us to
solve a problem with ruby. The result were measured by the <strong>fastest</strong>, <strong>slowest</strong>, <strong>shortest</strong>, <strong>longest</strong>,
<strong>cheaters</strong> (yup there are also some rule).</p>

<p>And also I was listening to an episode of ruby rouge on <a href="http://rubyrogues.com/034-rr-benchmarking-and-profiling/" title="034 RR Benchmarking and Profiling">Benchmarking</a>. And there is one tools called <a href="http://rubygems.org/gems/benchmark_suite" title="benchmark_suite">benchmark_suite</a>.</p>

<p>So there is this <a href="http://www.therubygame.com/challenges/3/submissions" title="Challenge #3">challenge</a> to capitalize first letter of every word. I want to compare my code to the fastest solution there.
so i installed the gem, also the <a href="http://rubygems.org/gems/ffi" title="ffi gem">ruby-ffi</a> gem that somewhat fix an error while I tried to run the benchmark.</p>

<p>so this is the code to benchmark it</p>

<div class='bogus-wrapper'><notextile><figure class='code'> <div class='highlight ruby'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;benchmark/ips&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;The small brown &amp; ginger fox JUMPED OVER the gate&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>    <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;first&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">string</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/\w+/</span><span class="p">){</span><span class="o">|</span><span class="n">w</span><span class="o">|</span> <span class="n">w</span><span class="o">.</span><span class="n">capitalize</span><span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;second&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:capitalize</span><span class="p">)</span><span class="o">.</span><span class="n">join</span> <span class="s1">&#39; &#39;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>And here is the result</p>

<p><code>first 55609.3 (±10.7%) i/s - 277202 in 5.048175s (cycle=4471)</code></p>

<p><code>second 77996.4 (±10.2%) i/s - 389844 in 5.055319s (cycle=6188)</code></p>

<p>The first code run <strong>55.609,3</strong> times per second and the latter is <strong>77.996,4</strong> times per second.
So the second code run more than the first code in one second. Which mean the second code is faster.</p>

<p>Also the first code run <strong>277.202</strong> times in <strong>5.048175</strong> sec while the second code run <strong>389.844</strong> times in <strong>5.05</strong> sec</p>

      </div>
    </div>
  </div>
      
  <footer>
     <p>&copy; Ahmy Yulrizka 2011</p>
  </footer>
</div> <!-- end of #container-->

<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/jquery-1.6.2.min.js"><\/script>')</script>

<script src="/javascripts/application.js"></script>

</body>
</html>